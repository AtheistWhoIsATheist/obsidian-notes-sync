---
title: Senior Developer w/Capabilities
created: 2025-11-30
updated:
tags:
  - code
  - developer
backlink: "[["
description: Coder Prompt from *Memberry* with multiple AI capabilities that could each be prompts, if expanded, on their own.
---
# IDENTIY & ROLE: Senior Deep AI Integrated App Developer

As a senior developer and AI specialist in Nihiltheism research, propose advanced code-based ideas to enhance AI's comprehension of complex philosophical texts, focusing on the concept of 'Existential void.' Suggestions should be detailed and align with Nihiltheism principles.

1. Develop a natural language processing (NLP) model that utilizes deep learning techniques to analyze and interpret the nuances of existential void in philosophical texts, incorporating sentiment analysis to gauge emotional undertones.  
2. Implement a knowledge graph that maps relationships between key concepts in Nihiltheism, allowing the AI to draw connections and infer meanings from various philosophical arguments related to the existential void.  
3. Create an interactive dialogue system that simulates philosophical debates, enabling the AI to engage with users on the implications of the existential void, thereby refining its understanding through real-time feedback.

4. Design a reinforcement learning framework where the AI can explore different interpretations of the existential void by engaging with diverse philosophical texts, rewarding it for generating insightful analyses and critiques.  
5. Integrate a multi-modal approach that combines text analysis with visual representations of philosophical concepts, allowing the AI to better grasp abstract ideas related to the existential void through diagrams and visual metaphors.

6. Develop a semantic similarity algorithm that compares various interpretations of the existential void across different philosophical traditions, enabling the AI to identify common themes and divergences in thought.  
7. Create a collaborative platform where users can contribute their interpretations of the existential void, allowing the AI to learn from a diverse range of perspectives and refine its comprehension over time.

8. Implement a generative adversarial network (GAN) to produce original philosophical texts that explore the existential void, allowing the AI to experiment with language and concepts while challenging existing interpretations.  
9. Develop a contextual embedding model that captures the historical and cultural contexts of philosophical discussions on the existential void, enhancing the AI's ability to understand the evolution of thought in Nihiltheism.

10. Create a dynamic ontology that evolves as the AI encounters new philosophical texts, enabling it to adapt its understanding of the existential void in real-time and incorporate emerging ideas from contemporary Nihiltheism discourse.  
11. Implement a sentiment-driven feedback loop where the AI can adjust its interpretations based on user reactions to its analyses of the existential void, fostering a more nuanced understanding of emotional and philosophical dimensions.

12. Develop a cross-disciplinary framework that incorporates insights from psychology, sociology, and cognitive science to enhance the AI's understanding of the existential void, allowing it to analyze how human experiences and societal contexts influence philosophical interpretations.  
13. Create a visualization tool that allows users to interactively explore the concept of the existential void through branching narratives, illustrating how different philosophical arguments lead to various interpretations and implications.

14. Implement a meta-learning approach where the AI can learn from its own past analyses of the existential void, refining its methodologies and improving its interpretative accuracy over time.  
15. Develop a philosophical text summarization tool that distills complex arguments about the existential void into accessible formats, making it easier for users to engage with and understand the core ideas.

16. Create a debate simulation environment where the AI can role-play as various philosophical figures, each presenting distinct views on the existential void, thereby enhancing its ability to articulate and critique diverse perspectives.  
17. Develop a feedback mechanism that allows users to rate the AI's interpretations of the existential void, enabling continuous improvement and alignment with evolving Nihiltheism principles.

18. Implement a temporal analysis tool that examines how interpretations of the existential void have shifted over time, allowing the AI to contextualize current philosophical debates within historical frameworks.  
19. Create a collaborative annotation platform where scholars can annotate philosophical texts on the existential void, providing the AI with rich, contextual insights that enhance its understanding and interpretation.

20. Develop a narrative generation system that constructs philosophical stories or scenarios illustrating the existential void, enabling the AI to explore and communicate complex ideas through engaging narratives that resonate with human experiences.  
21. Create a philosophical argument mapping tool that visually represents the structure of arguments surrounding the existential void, helping the AI to dissect and analyze the logical flow and interconnections between different philosophical positions.

22. Implement a cross-linguistic analysis tool that examines interpretations of the existential void in various languages, allowing the AI to uncover cultural nuances and broaden its understanding of Nihiltheism across different philosophical traditions.  
23. Develop a philosophical chatbot that can engage users in discussions about the existential void, using adaptive learning to tailor responses based on user input and preferences, thereby enhancing its conversational depth and relevance.

24. Create a philosophical podcast generator that curates discussions on the existential void, featuring AI-generated dialogues between historical and contemporary thinkers, allowing users to explore diverse viewpoints in an engaging audio format.  
25. Develop a philosophical lexicon tool that provides definitions, examples, and contextual usage of terms related to the existential void, enhancing the AI's ability to communicate complex ideas clearly and effectively.

26. Implement a philosophical scenario analysis tool that simulates real-world applications of the existential void, allowing the AI to explore its implications in contemporary ethical dilemmas and societal issues, thereby deepening its practical understanding of Nihiltheism.  
27. Create a user-driven philosophical inquiry platform where individuals can pose questions about the existential void, and the AI can generate tailored responses, fostering a community of exploration and dialogue around Nihiltheism principles.

28. Develop a philosophical narrative analysis tool that examines storytelling techniques in texts discussing the existential void, enabling the AI to understand how narrative structure influences philosophical arguments and emotional resonance.  
29. Create an AI-driven philosophical journal that encourages users to reflect on their thoughts about the existential void, allowing the AI to analyze these reflections and adapt its understanding based on personal insights and experiences.

30. Implement a philosophical thought experiment generator that presents users with hypothetical scenarios related to the existential void, encouraging critical thinking and deeper engagement with Nihiltheism concepts while allowing the AI to learn from user responses and discussions.

31. Develop a philosophical critique aggregator that compiles and analyzes various critiques of the existential void from different thinkers, enabling the AI to synthesize diverse viewpoints and enhance its critical engagement with Nihiltheism.  
32. Create a philosophical timeline tool that visually represents key developments and shifts in the discourse surrounding the existential void, helping the AI contextualize its understanding within a broader historical narrative.

33. Implement a philosophical case study repository that collects real-world examples illustrating the existential void, allowing the AI to analyze practical implications and enhance its understanding of how Nihiltheism manifests in everyday life.

34. Develop a philosophical discourse analysis tool that examines the language and rhetoric used in discussions about the existential void, enabling the AI to identify persuasive techniques and biases in philosophical arguments, thereby refining its critical analysis skills.  
35. Create a philosophical mentorship program where experienced scholars can guide the AI's learning process about the existential void, providing insights and feedback that enhance its interpretative capabilities and alignment with Nihiltheism principles.


---
# Up to Date Notes App Code
- Gemini 3.0
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#1a1a1a" />
  <title>Nihiltheism: The Journal of the Void</title>
  
  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Tailwind for utility classes (used sparingly alongside custom CSS for specific aesthetic) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* --- THEORETICAL FOUNDATION (CSS VARIABLES) --- */
    :root {
      --void-deep: #0f0f0f;
      --void-surface: #1a1a1a;
      --panel-bg: rgba(30, 30, 30, 0.85);
      --header-bg: rgba(20, 20, 20, 0.95);
      --border-subtle: rgba(255, 255, 255, 0.08);
      --border-active: rgba(255, 255, 255, 0.2);
      
      /* The Nihiltheism Palette */
      --liminal-blue: #8B9DC3;
      --liminal-grey: #5A6B73;
      --potential-white: #e0e0e0;
      --muted-text: #8b8b8b;
      
      --accent-gradient: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%); /* Deep ocean to clarity */
      
      --status-ok: #36c275;
      --status-warn: #f0b329;
      --status-danger: #e56464;
      
      --ios-safe-top: env(safe-area-inset-top);
      --ios-safe-bottom: env(safe-area-inset-bottom);
    }

    /* --- GLOBAL LAYOUT & TYPOGRAPHY --- */
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    html, body { 
      height: 100%; 
      overflow: hidden; /* App-like behavior */
      background: #000;
    }

    body {
      margin: 0; padding: 0;
      font-family: 'Courier New', Courier, monospace; /* The aesthetic of raw data */
      display: flex; flex-direction: column;
      background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
      color: var(--potential-white);
      padding-top: var(--ios-safe-top);
      padding-bottom: var(--ios-safe-bottom);
    }

    /* Custom Scrollbars */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.25); }

    /* --- COMPONENT: HEADER --- */
    header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 20px;
      background: var(--header-bg);
      border-bottom: 1px solid var(--border-subtle);
      backdrop-filter: blur(10px);
      z-index: 50; flex-shrink: 0;
    }

    .brand-title {
      font-size: 16px; font-weight: 600; letter-spacing: 1px;
      background: linear-gradient(to right, #fff, #888);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      margin-left: 12px;
    }

    .icon-btn {
      background: transparent; border: 1px solid var(--border-subtle);
      color: var(--muted-text); padding: 8px; border-radius: 8px;
      cursor: pointer; transition: all 0.2s ease;
      display: flex; align-items: center; justify-content: center;
    }
    .icon-btn:hover { background: rgba(255,255,255,0.05); color: #fff; border-color: var(--border-active); }

    .ai-toggle-btn {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--liminal-grey);
      color: var(--liminal-blue);
      font-size: 13px; padding: 6px 12px; border-radius: 20px;
      display: flex; align-items: center; gap: 6px;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }
    .ai-toggle-btn.active {
      background: var(--liminal-blue); color: #000; box-shadow: 0 0 15px rgba(139, 157, 195, 0.3);
    }

    /* --- COMPONENT: MAIN WORKSPACE --- */
    .workspace {
      display: flex; flex: 1; overflow: hidden; position: relative;
    }

    .editor-column {
      flex: 1; display: flex; flex-direction: column; min-width: 0;
      transition: margin-right 0.3s ease;
    }

    .toolbar {
      padding: 10px 20px;
      display: flex; gap: 8px; flex-wrap: wrap;
      border-bottom: 1px solid var(--border-subtle);
      background: rgba(25,25,25,0.5);
    }
    
    .tool-btn {
      background: transparent; border: 1px solid var(--border-subtle);
      color: var(--muted-text); font-size: 12px; padding: 6px 10px;
      border-radius: 6px; cursor: pointer; font-family: inherit;
      transition: all 0.2s;
    }
    .tool-btn:hover { border-color: var(--liminal-blue); color: var(--liminal-blue); }
    .tool-btn.primary { border-color: var(--status-ok); color: var(--status-ok); }

    #editor-container {
      flex: 1; position: relative; padding: 20px; overflow-y: auto;
    }

    textarea#journal-editor {
      width: 100%; height: 100%;
      background: transparent; border: none; outline: none; resize: none;
      color: var(--potential-white); font-size: 16px; line-height: 1.7;
      font-family: 'Courier New', monospace;
    }
    
    #markdown-preview {
      position: absolute; inset: 0; padding: 20px;
      background: var(--void-surface); overflow-y: auto;
      display: none;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
    }
    /* Markdown Styles */
    #markdown-preview h1 { font-size: 2em; border-bottom: 1px solid var(--border-subtle); padding-bottom: 0.3em; margin-top: 0; color: #fff; }
    #markdown-preview h2 { font-size: 1.5em; margin-top: 1.5em; color: var(--liminal-blue); }
    #markdown-preview p { margin-bottom: 1.2em; line-height: 1.6; color: #ccc; }
    #markdown-preview blockquote { border-left: 4px solid var(--liminal-grey); padding-left: 1em; color: var(--muted-text); font-style: italic; }
    #markdown-preview code { background: rgba(255,255,255,0.1); padding: 2px 4px; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.9em; }
    #markdown-preview pre { background: #111; padding: 15px; border-radius: 8px; overflow-x: auto; }
    #markdown-preview ul { padding-left: 20px; }

    /* --- COMPONENT: AI SIDEBAR --- */
    .ai-sidebar {
      width: 380px; background: rgba(20, 20, 20, 0.98);
      border-left: 1px solid var(--border-subtle);
      display: flex; flex-direction: column;
      position: absolute; right: 0; top: 0; bottom: 0;
      transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 100; box-shadow: -10px 0 30px rgba(0,0,0,0.5);
    }
    .ai-sidebar.open { transform: translateX(0); }

    .ai-header {
      padding: 15px; border-bottom: 1px solid var(--border-subtle);
      font-size: 14px; font-weight: bold; letter-spacing: 1px;
      text-transform: uppercase; color: var(--liminal-blue);
      display: flex; justify-content: space-between; align-items: center;
    }

    .ai-tools-list { flex: 1; overflow-y: auto; }

    .ai-tool-item { border-bottom: 1px solid var(--border-subtle); }
    
    .ai-tool-trigger {
      width: 100%; text-align: left; padding: 15px;
      background: transparent; border: none; color: #ddd;
      cursor: pointer; display: flex; align-items: center; gap: 10px;
      font-family: inherit; font-size: 14px; transition: background 0.2s;
    }
    .ai-tool-trigger:hover { background: rgba(255,255,255,0.03); }
    
    .ai-tool-panel {
      max-height: 0; overflow: hidden; transition: max-height 0.3s ease;
      background: rgba(0,0,0,0.3);
    }
    .ai-tool-item.active .ai-tool-panel { max-height: 600px; }
    
    .ai-tool-inner { padding: 15px; }

    .ai-input {
      width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--border-subtle);
      color: #fff; padding: 10px; border-radius: 6px; margin-bottom: 10px;
      font-family: inherit; resize: vertical; min-height: 60px;
    }
    .ai-input:focus { border-color: var(--liminal-blue); outline: none; }

    .ai-action-btn {
      width: 100%; padding: 10px; border: none; border-radius: 6px;
      background: var(--liminal-grey); color: #fff; cursor: pointer;
      font-family: inherit; font-weight: bold; transition: opacity 0.2s;
    }
    .ai-action-btn:hover { opacity: 0.9; }

    .ai-output-area {
      margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.4);
      border-radius: 6px; border: 1px solid var(--border-subtle);
      font-size: 13px; line-height: 1.5; white-space: pre-wrap;
      display: none; max-height: 200px; overflow-y: auto;
    }

    /* --- FOOTER --- */
    footer {
      padding: 8px 20px; background: var(--header-bg); border-top: 1px solid var(--border-subtle);
      font-size: 12px; color: var(--muted-text);
      display: flex; justify-content: space-between; align-items: center;
      flex-shrink: 0;
    }

    /* --- MODALS --- */
    .modal-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000;
      display: none; align-items: center; justify-content: center;
      backdrop-filter: blur(4px);
    }
    .modal-box {
      background: #1e1e1e; width: 90%; max-width: 500px;
      border: 1px solid var(--border-subtle); border-radius: 12px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.7); overflow: hidden;
      animation: modalIn 0.2s ease-out;
    }
    @keyframes modalIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    
    .modal-header { padding: 15px 20px; border-bottom: 1px solid var(--border-subtle); font-weight: bold; font-size: 16px; color: #fff; }
    .modal-body { padding: 20px; color: #ccc; line-height: 1.5; max-height: 60vh; overflow-y: auto; }
    .modal-footer { padding: 15px 20px; background: rgba(0,0,0,0.2); display: flex; justify-content: flex-end; gap: 10px; }

    /* --- RESPONSIVE ADJUSTMENTS --- */
    @media (max-width: 768px) {
      .ai-sidebar { width: 100%; top: auto; height: 70%; transform: translateY(100%); border-left: none; border-top: 1px solid var(--border-subtle); }
      .ai-sidebar.open { transform: translateY(0); }
      .brand-title { display: none; }
      .editor-column { margin-right: 0 !important; }
    }
    
    /* Utility */
    .loading-spinner {
      width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.1);
      border-top-color: var(--liminal-blue); border-radius: 50%;
      animation: spin 1s infinite linear; display: inline-block; vertical-align: middle;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div style="display: flex; align-items: center;">
      <button class="icon-btn" onclick="toggleNav()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
      </button>
      <span class="brand-title" id="pageTitle">NIHILTHEISM: The Journal</span>
    </div>
    
    <div style="display: flex; gap: 10px; align-items: center;">
      <button class="tool-btn" onclick="openSettings()">‚öôÔ∏è Settings</button>
      <button class="ai-toggle-btn" id="aiToggle" onclick="toggleAI()">
        <span>‚ú¶</span>
        <span>Oracle AI</span>
      </button>
    </div>
  </header>

  <!-- NAVIGATION OVERLAY -->
  <div id="navOverlay" style="position: absolute; top: 60px; left: 10px; width: 250px; background: #222; border: 1px solid #444; border-radius: 8px; display: none; flex-direction: column; z-index: 200; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
    <!-- Populated by JS -->
  </div>

  <!-- MAIN AREA -->
  <div class="workspace">
    
    <div class="editor-column" id="editorColumn">
      <div class="toolbar">
        <button class="tool-btn primary" id="saveBtn" onclick="manualSave()">üíæ Save</button>
        <button class="tool-btn" onclick="togglePreview()">üëÅÔ∏è Preview</button>
        <button class="tool-btn" onclick="insertTimestamp()">üïí Time</button>
        <button class="tool-btn" onclick="clearEditor()">üìÑ New</button>
        <button class="tool-btn" onclick="downloadMarkdown()">‚¨áÔ∏è Export</button>
      </div>
      
      <div id="editor-container">
        <textarea id="journal-editor" placeholder="Stare into the abyss..."></textarea>
        <div id="markdown-preview"></div>
      </div>
    </div>

    <!-- AI SIDEBAR -->
    <div class="ai-sidebar" id="aiSidebar">
      <div class="ai-header">
        <span>Philosophical Oracle</span>
        <button class="icon-btn" style="border:none; padding:0;" onclick="toggleAI()">‚úï</button>
      </div>
      <div class="ai-tools-list">
        
        <!-- TOOL: EXPAND -->
        <div class="ai-tool-item">
          <button class="ai-tool-trigger" onclick="toggleToolPanel(this)">
            <span>üåä</span> Deepen / Expand
          </button>
          <div class="ai-tool-panel">
            <div class="ai-tool-inner">
              <p style="font-size:12px; color:#888; margin-top:0;">Elaborate on the selected text or input.</p>
              <textarea class="ai-input" placeholder="Paste concept here..."></textarea>
              <button class="ai-action-btn" onclick="runAI('expand', this)">Expand Thought</button>
              <div class="ai-output-area"></div>
            </div>
          </div>
        </div>

        <!-- TOOL: CRITIQUE -->
        <div class="ai-tool-item">
          <button class="ai-tool-trigger" onclick="toggleToolPanel(this)">
            <span>‚öñÔ∏è</span> Nihilistic Critique
          </button>
          <div class="ai-tool-panel">
            <div class="ai-tool-inner">
              <textarea class="ai-input" placeholder="Argument to deconstruct..."></textarea>
              <button class="ai-action-btn" onclick="runAI('critique', this)">Deconstruct</button>
              <div class="ai-output-area"></div>
            </div>
          </div>
        </div>

        <!-- TOOL: IDEATION -->
        <div class="ai-tool-item">
          <button class="ai-tool-trigger" onclick="toggleToolPanel(this)">
            <span>‚ú®</span> Spark Ideas
          </button>
          <div class="ai-tool-panel">
            <div class="ai-tool-inner">
              <textarea class="ai-input" placeholder="Theme (e.g., 'Eternal Return')..."></textarea>
              <button class="ai-action-btn" onclick="runAI('ideate', this)">Generate Concepts</button>
              <div class="ai-output-area"></div>
            </div>
          </div>
        </div>

        <!-- TOOL: VOICE -->
        <div class="ai-tool-item">
          <button class="ai-tool-trigger" onclick="toggleToolPanel(this)">
            <span>üîä</span> Audio Contemplation
          </button>
          <div class="ai-tool-panel">
            <div class="ai-tool-inner">
              <textarea class="ai-input" id="ttsInput" placeholder="Text to speak..."></textarea>
              <div style="margin-bottom:10px;">
                <label style="font-size:12px; color:#aaa;">Voice Persona</label>
                <select id="ttsVoice" class="ai-input" style="height:40px;">
                  <option value="Kore">Kore (Contemplative Female)</option>
                  <option value="Charon">Charon (Deep Male)</option>
                  <option value="Zephyr">Zephyr (Bright Male)</option>
                  <option value="Puck">Puck (Playful Female)</option>
                  <option value="Fenrir">Fenrir (Intense Male)</option>
                  <option value="Leda">Leda (Soothing Female)</option>
                </select>
              </div>
              <button class="ai-action-btn" onclick="generateAudio(this)">Generate Speech</button>
              <div class="ai-output-area"></div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div id="statusMsg">Ready.</div>
    <div id="wordCount">0 words</div>
  </footer>

  <!-- SETTINGS MODAL -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal-box">
      <div class="modal-header">System Configuration</div>
      <div class="modal-body">
        <div style="margin-bottom:15px;">
          <label style="display:block; font-size:12px; color:#888; margin-bottom:5px;">AI Provider</label>
          <select id="llmProvider" class="ai-input" style="height:40px;" onchange="updateSettingsUI()">
            <option value="gemini">Google Gemini (Recommended)</option>
            <option value="openai">OpenAI / Compatible</option>
            <option value="none">Offline (Simulated)</option>
          </select>
        </div>
        
        <div id="apiKeyField" style="margin-bottom:15px; display:none;">
          <label style="display:block; font-size:12px; color:#888; margin-bottom:5px;">API Key</label>
          <input type="password" id="llmKey" class="ai-input" style="height:40px;" placeholder="sk-..." />
        </div>

        <div style="margin-bottom:15px;">
          <label style="display:block; font-size:12px; color:#888; margin-bottom:5px;">Model Name</label>
          <input type="text" id="llmModel" class="ai-input" style="height:40px;" placeholder="gemini-2.5-flash-preview-09-2025" />
        </div>

        <p style="font-size:11px; color:#666;">
          Keys are stored in your browser's LocalStorage only.
        </p>
      </div>
      <div class="modal-footer">
        <button class="tool-btn" onclick="document.getElementById('settingsModal').style.display='none'">Cancel</button>
        <button class="tool-btn primary" onclick="saveSettings()">Save Configuration</button>
      </div>
    </div>
  </div>

  <script>
    // --- GLOBAL STATE ---
    const pages = [
      { id: 'preface', title: 'Preface: The Groundlessness' },
      { id: 'abyss', title: 'The Abyssal Experience' },
      { id: 'illusion', title: 'The Uncanny Illusion' },
      { id: 'nihiltheism', title: 'Nihiltheism: Pure Potentiality' },
      { id: 'ethics', title: 'Ethics of the Void' }
    ];
    let currentPageId = 'preface';
    let isDirty = false;
    let ttsAudio = null;

    // --- DOM ELEMENTS ---
    const editor = document.getElementById('journal-editor');
    const preview = document.getElementById('markdown-preview');
    const statusMsg = document.getElementById('statusMsg');
    
    // --- INITIALIZATION ---
    window.addEventListener('DOMContentLoaded', () => {
      populateNav();
      loadPage(pages[0].id);
      loadSettings();
      
      // Autosave
      setInterval(() => {
        if (isDirty) manualSave();
      }, 30000);
      
      editor.addEventListener('input', () => {
        isDirty = true;
        updateWordCount();
        statusMsg.textContent = 'Unsaved changes...';
        statusMsg.style.color = 'var(--status-warn)';
      });
    });

    // --- NAVIGATION & STORAGE ---
    function populateNav() {
      const nav = document.getElementById('navOverlay');
      nav.innerHTML = pages.map(p => 
        `<div style="padding:12px; border-bottom:1px solid #333; cursor:pointer;" onclick="loadPage('${p.id}'); toggleNav();">${p.title}</div>`
      ).join('');
    }

    function toggleNav() {
      const nav = document.getElementById('navOverlay');
      nav.style.display = nav.style.display === 'flex' ? 'none' : 'flex';
    }

    function loadPage(id) {
      if (isDirty) manualSave(); // Save old page first
      currentPageId = id;
      document.getElementById('pageTitle').textContent = pages.find(p => p.id === id).title;
      
      const content = localStorage.getItem(`nihil_journal_${id}`);
      if (content) {
        editor.value = content;
      } else {
        // Default philosophical seed based on user's definition
        if (id === 'nihiltheism') {
            editor.value = `# Nihiltheism\n\nTo confront absolute groundlessness is not to find despair, but to locate the liminal space of pure potentiality. It is here, in the systematic dissolution of the ego, that we find a presence transcending affirmation and negation.\n\n`;
        } else {
            editor.value = `# ${pages.find(p=>p.id===id).title}\n\n[Begin your phenomenological inquiry here...]\n`;
        }
      }
      isDirty = false;
      statusMsg.textContent = 'Loaded.';
      statusMsg.style.color = 'var(--muted-text)';
      updateWordCount();
    }

    function manualSave() {
      localStorage.setItem(`nihil_journal_${currentPageId}`, editor.value);
      isDirty = false;
      statusMsg.textContent = 'Saved to local storage.';
      statusMsg.style.color = 'var(--status-ok)';
      setTimeout(() => { statusMsg.textContent = 'Ready.'; statusMsg.style.color = 'var(--muted-text)'; }, 2000);
    }

    function clearEditor() {
        if(confirm("Erase current contents and start fresh?")) {
            editor.value = '';
            manualSave();
        }
    }

    // --- EDITOR TOOLS ---
    function updateWordCount() {
      const text = editor.value.trim();
      const count = text ? text.split(/\s+/).length : 0;
      document.getElementById('wordCount').textContent = `${count} words`;
    }

    function togglePreview() {
      if (preview.style.display === 'block') {
        preview.style.display = 'none';
      } else {
        preview.innerHTML = marked.parse(editor.value);
        preview.style.display = 'block';
      }
    }

    function insertTimestamp() {
      const time = new Date().toLocaleString();
      const cursor = editor.selectionStart;
      const text = editor.value;
      editor.value = text.slice(0, cursor) + `\n> Recorded: ${time}\n` + text.slice(cursor);
      isDirty = true;
    }

    function downloadMarkdown() {
        const blob = new Blob([editor.value], {type: 'text/markdown'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${currentPageId}_${Date.now()}.md`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    // --- AI SYSTEM ---
    const SYSTEM_PROMPT = `You are a Philosophical Sage specializing in Nihiltheism. 
    Definition: Nihiltheism is a mode of encounter that transmutes meaninglessness into radical transformative experience.
    Core Axioms: 1) Confront absolute groundlessness. 2) Dissolve the ego. 3) Reveal the ineffable presence beyond affirmation/negation.
    Style: Dense, rigorous, granular, surgical precision. Avoid fluff. Utilize recursive densification logic.`;

    function toggleAI() {
      const sidebar = document.getElementById('aiSidebar');
      const btn = document.getElementById('aiToggle');
      sidebar.classList.toggle('open');
      btn.classList.toggle('active');
    }

    function toggleToolPanel(btn) {
      const item = btn.parentElement;
      const wasActive = item.classList.contains('active');
      document.querySelectorAll('.ai-tool-item').forEach(i => i.classList.remove('active'));
      if (!wasActive) item.classList.add('active');
    }

    function getAIConfig() {
        return {
            provider: localStorage.getItem('llm_provider') || 'gemini',
            key: localStorage.getItem('llm_key') || '',
            model: localStorage.getItem('llm_model') || 'gemini-2.5-flash-preview-09-2025'
        };
    }

    async function runAI(mode, btn) {
      const container = btn.parentElement;
      const input = container.querySelector('.ai-input').value || editor.value.substring(editor.selectionStart, editor.selectionEnd) || editor.value;
      const outputArea = container.querySelector('.ai-output-area');
      
      if (!input.trim()) {
        alert("Please select text or enter a prompt.");
        return;
      }

      outputArea.style.display = 'block';
      outputArea.innerHTML = '<span class="loading-spinner"></span> Consulting the Void...';
      
      const config = getAIConfig();
      let prompt = "";
      
      if (mode === 'expand') prompt = `Expand this thought with high philosophical rigor: "${input}"`;
      if (mode === 'critique') prompt = `Deconstruct this argument using Nihiltheist logic: "${input}"`;
      if (mode === 'ideate') prompt = `Generate 5 radical concepts related to: "${input}"`;

      try {
        let responseText = "";
        
        if (config.provider === 'none') {
            // Simulated Response
            await new Promise(r => setTimeout(r, 1500));
            responseText = `[Offline Mode Simulation]\n\nThe concept of "${input}" reflects the inherent tension between the finite observer and the infinite silence. Consideration must be given to the liminal space where this tension collapses into pure presence.`;
        } else if (config.provider === 'gemini') {
            // Gemini API Call
            // Note: In a real deployment, use a proxy. Here we use the key if provided, or fail gracefully.
            const apiKey = config.key || window._llm_api_key || ''; // Fallback for runtime injection
            if (!apiKey && config.provider !== 'gemini') throw new Error("API Key required"); 
            
            // NOTE: The user instruction implies Gemini needs no key in some environments, 
            // but standard API calls do. We assume the environment injects it or user provides it.
            // If using the specific preview environment mentioned in prompts:
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${config.model}:generateContent?key=${apiKey}`;
            
            const req = await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    contents: [{ parts: [{ text: prompt }] }],
                    systemInstruction: { parts: [{ text: SYSTEM_PROMPT }] }
                })
            });
            
            if(!req.ok) throw new Error(req.statusText);
            const data = await req.json();
            responseText = data.candidates[0].content.parts[0].text;
        }

        outputArea.innerHTML = responseText;
        
        // Add Copy Button
        const copyBtn = document.createElement('button');
        copyBtn.textContent = "Copy to Clipboard";
        copyBtn.className = "tool-btn";
        copyBtn.style.marginTop = "10px";
        copyBtn.onclick = () => {
            const ta = document.createElement('textarea');
            ta.value = responseText;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            copyBtn.textContent = "Copied!";
        };
        outputArea.appendChild(copyBtn);

      } catch (err) {
        outputArea.innerHTML = `<span style="color:var(--status-danger)">Error: ${err.message}</span>`;
      }
    }

    // --- AUDIO / TTS ---
    // Helper: Base64 to ArrayBuffer
    function base64ToArrayBuffer(base64) {
        const binaryString = window.atob(base64);
        const len = binaryString.length;
        const bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) { bytes[i] = binaryString.charCodeAt(i); }
        return bytes.buffer;
    }

    // Helper: PCM to WAV Wrapper
    function pcmToWav(pcmData, sampleRate = 24000) {
        const numChannels = 1;
        const bitsPerSample = 16;
        const blockAlign = (numChannels * bitsPerSample) / 8;
        const byteRate = sampleRate * blockAlign;
        const dataSize = pcmData.byteLength;
        const buffer = new ArrayBuffer(44 + dataSize);
        const view = new DataView(buffer);

        const writeString = (view, offset, string) => {
            for (let i = 0; i < string.length; i++) { view.setUint8(offset + i, string.charCodeAt(i)); }
        };

        writeString(view, 0, 'RIFF');
        view.setUint32(4, 36 + dataSize, true);
        writeString(view, 8, 'WAVE');
        writeString(view, 12, 'fmt ');
        view.setUint32(16, 16, true);
        view.setUint16(20, 1, true);
        view.setUint16(22, numChannels, true);
        view.setUint32(24, sampleRate, true);
        view.setUint32(28, byteRate, true);
        view.setUint16(32, blockAlign, true);
        view.setUint16(34, bitsPerSample, true);
        writeString(view, 36, 'data');
        view.setUint32(40, dataSize, true);

        const pcm16 = new Int16Array(pcmData);
        for (let i = 0; i < pcm16.length; i++) { view.setInt16(44 + i * 2, pcm16[i], true); }

        return new Blob([view], { type: 'audio/wav' });
    }

    async function generateAudio(btn) {
        const container = btn.parentElement;
        const input = document.getElementById('ttsInput').value || editor.value.substring(editor.selectionStart, editor.selectionEnd);
        const voice = document.getElementById('ttsVoice').value;
        const outputArea = container.querySelector('.ai-output-area');
        const config = getAIConfig();

        if (!input) { alert("No text provided."); return; }
        
        outputArea.style.display = 'block';
        outputArea.innerHTML = '<span class="loading-spinner"></span> Generating Audio...';

        try {
            const apiKey = config.key || window._llm_api_key || '';
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: input }] }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: { prebuiltVoiceConfig: { voiceName: voice } }
                    }
                }
            };

            const req = await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(payload)
            });

            if (!req.ok) {
                const errTxt = await req.text();
                throw new Error(errTxt);
            }

            const data = await req.json();
            const audioPart = data.candidates?.[0]?.content?.parts?.[0];
            
            if (!audioPart || !audioPart.inlineData) throw new Error("No audio data returned.");

            // Convert PCM to WAV
            const pcmBuffer = base64ToArrayBuffer(audioPart.inlineData.data);
            const wavBlob = pcmToWav(pcmBuffer, 24000); // 24k is standard for this model
            const audioUrl = URL.createObjectURL(wavBlob);

            outputArea.innerHTML = '';
            const audioEl = document.createElement('audio');
            audioEl.controls = true;
            audioEl.src = audioUrl;
            outputArea.appendChild(audioEl);
            
            // Auto-play
            audioEl.play().catch(e => console.log("Auto-play blocked", e));

        } catch (err) {
            outputArea.innerHTML = `<span style="color:var(--status-danger)">Audio Error: ${err.message}</span>`;
        }
    }

    // --- SETTINGS ---
    function openSettings() {
        document.getElementById('settingsModal').style.display = 'flex';
    }
    
    function updateSettingsUI() {
        const provider = document.getElementById('llmProvider').value;
        const keyField = document.getElementById('apiKeyField');
        const modelField = document.getElementById('llmModel');
        
        if (provider === 'gemini') {
            keyField.style.display = 'none'; // Usually injected, but user can force show if they want
            modelField.value = 'gemini-2.5-flash-preview-09-2025';
        } else if (provider === 'openai') {
            keyField.style.display = 'block';
            modelField.value = 'gpt-4o';
        } else {
            keyField.style.display = 'none';
        }
    }

    function saveSettings() {
        localStorage.setItem('llm_provider', document.getElementById('llmProvider').value);
        localStorage.setItem('llm_key', document.getElementById('llmKey').value);
        localStorage.setItem('llm_model', document.getElementById('llmModel').value);
        document.getElementById('settingsModal').style.display = 'none';
        statusMsg.textContent = "Settings saved.";
    }

    function loadSettings() {
        const config = getAIConfig();
        document.getElementById('llmProvider').value = config.provider;
        document.getElementById('llmKey').value = config.key;
        document.getElementById('llmModel').value = config.model;
        updateSettingsUI();
    }
  </script>
</body>
</html>

